{
  "$schema": "casare_rpa/workflow_template/1.0",
  "id": "tmpl_excel_001",
  "metadata": {
    "name": "Excel Data Extraction",
    "description": "Extracts data from Excel files with support for multiple sheets, filtering, and data transformation. Outputs structured JSON or CSV data.",
    "category": "excel_automation",
    "version": "1.0.0",
    "author": "CasareRPA",
    "tags": ["excel", "data", "extraction", "spreadsheet", "csv", "etl"],
    "created_at": "2024-11-28T00:00:00",
    "modified_at": "2024-11-28T00:00:00",
    "icon": "spreadsheet",
    "preview_image": "",
    "difficulty": "beginner",
    "estimated_duration": "1-10 minutes",
    "requirements": ["openpyxl", "pandas"]
  },
  "parameters": [
    {
      "name": "input_file",
      "display_name": "Input Excel File",
      "description": "Path to the Excel file (.xlsx, .xls) to read",
      "param_type": "file_path",
      "default_value": null,
      "required": true,
      "constraints": {},
      "group": "Input",
      "order": 0
    },
    {
      "name": "sheet_name",
      "display_name": "Sheet Name",
      "description": "Name of the sheet to read (leave empty for first sheet)",
      "param_type": "string",
      "default_value": "",
      "required": false,
      "constraints": {},
      "group": "Input",
      "order": 1
    },
    {
      "name": "header_row",
      "display_name": "Header Row",
      "description": "Row number containing column headers (1-based)",
      "param_type": "integer",
      "default_value": 1,
      "required": false,
      "constraints": {"min": 1},
      "group": "Input",
      "order": 2
    },
    {
      "name": "start_row",
      "display_name": "Start Row",
      "description": "First data row to read (1-based, after header)",
      "param_type": "integer",
      "default_value": 2,
      "required": false,
      "constraints": {"min": 1},
      "group": "Data Range",
      "order": 3
    },
    {
      "name": "end_row",
      "display_name": "End Row",
      "description": "Last row to read (0 = all rows)",
      "param_type": "integer",
      "default_value": 0,
      "required": false,
      "constraints": {"min": 0},
      "group": "Data Range",
      "order": 4
    },
    {
      "name": "columns",
      "display_name": "Columns to Extract",
      "description": "List of column names/letters to extract (empty = all columns)",
      "param_type": "list",
      "default_value": [],
      "required": false,
      "constraints": {},
      "group": "Data Range",
      "order": 5
    },
    {
      "name": "filter_column",
      "display_name": "Filter Column",
      "description": "Column to apply filter on (optional)",
      "param_type": "string",
      "default_value": "",
      "required": false,
      "constraints": {},
      "group": "Filtering",
      "order": 6
    },
    {
      "name": "filter_value",
      "display_name": "Filter Value",
      "description": "Value to filter by in the filter column",
      "param_type": "string",
      "default_value": "",
      "required": false,
      "constraints": {},
      "group": "Filtering",
      "order": 7
    },
    {
      "name": "output_format",
      "display_name": "Output Format",
      "description": "Format for the extracted data",
      "param_type": "choice",
      "default_value": "json",
      "required": false,
      "constraints": {"choices": ["json", "csv", "list"]},
      "group": "Output",
      "order": 8
    },
    {
      "name": "output_file",
      "display_name": "Output File",
      "description": "Path to save extracted data (optional)",
      "param_type": "file_path",
      "default_value": "",
      "required": false,
      "constraints": {},
      "group": "Output",
      "order": 9
    }
  ],
  "workflow_definition": {
    "metadata": {
      "name": "Excel Data Extraction Workflow",
      "description": "Generated from Excel Data Extraction template",
      "version": "1.0.0"
    },
    "nodes": {
      "start_001": {
        "node_id": "start_001",
        "node_type": "StartNode",
        "name": "Start",
        "position": [100, 200],
        "config": {}
      },
      "read_excel_001": {
        "node_id": "read_excel_001",
        "node_type": "ReadExcelNode",
        "name": "Read Excel File",
        "position": [300, 200],
        "config": {
          "file_path": "{{input_file}}",
          "sheet_name": "{{sheet_name}}",
          "header_row": "{{header_row}}",
          "start_row": "{{start_row}}",
          "end_row": "{{end_row}}"
        }
      },
      "filter_001": {
        "node_id": "filter_001",
        "node_type": "FilterDataNode",
        "name": "Filter Data",
        "position": [500, 200],
        "config": {
          "column": "{{filter_column}}",
          "value": "{{filter_value}}",
          "enabled": true
        }
      },
      "select_columns_001": {
        "node_id": "select_columns_001",
        "node_type": "SelectColumnsNode",
        "name": "Select Columns",
        "position": [700, 200],
        "config": {
          "columns": "{{columns}}"
        }
      },
      "transform_001": {
        "node_id": "transform_001",
        "node_type": "TransformDataNode",
        "name": "Format Output",
        "position": [900, 200],
        "config": {
          "output_format": "{{output_format}}"
        }
      },
      "branch_001": {
        "node_id": "branch_001",
        "node_type": "BranchNode",
        "name": "Save to File?",
        "position": [1100, 200],
        "config": {
          "condition": "{{output_file}} != ''"
        }
      },
      "write_file_001": {
        "node_id": "write_file_001",
        "node_type": "WriteFileNode",
        "name": "Save Output",
        "position": [1300, 100],
        "config": {
          "file_path": "{{output_file}}"
        }
      },
      "log_001": {
        "node_id": "log_001",
        "node_type": "LogNode",
        "name": "Log Result",
        "position": [1300, 300],
        "config": {
          "message": "Extracted {{row_count}} rows from Excel file"
        }
      },
      "end_001": {
        "node_id": "end_001",
        "node_type": "EndNode",
        "name": "End",
        "position": [1500, 200],
        "config": {}
      }
    },
    "connections": [
      {"source_node": "start_001", "source_port": "exec_out", "target_node": "read_excel_001", "target_port": "exec_in"},
      {"source_node": "read_excel_001", "source_port": "exec_out", "target_node": "filter_001", "target_port": "exec_in"},
      {"source_node": "read_excel_001", "source_port": "data", "target_node": "filter_001", "target_port": "data"},
      {"source_node": "filter_001", "source_port": "exec_out", "target_node": "select_columns_001", "target_port": "exec_in"},
      {"source_node": "filter_001", "source_port": "data", "target_node": "select_columns_001", "target_port": "data"},
      {"source_node": "select_columns_001", "source_port": "exec_out", "target_node": "transform_001", "target_port": "exec_in"},
      {"source_node": "select_columns_001", "source_port": "data", "target_node": "transform_001", "target_port": "data"},
      {"source_node": "transform_001", "source_port": "exec_out", "target_node": "branch_001", "target_port": "exec_in"},
      {"source_node": "branch_001", "source_port": "true", "target_node": "write_file_001", "target_port": "exec_in"},
      {"source_node": "branch_001", "source_port": "false", "target_node": "log_001", "target_port": "exec_in"},
      {"source_node": "write_file_001", "source_port": "exec_out", "target_node": "end_001", "target_port": "exec_in"},
      {"source_node": "log_001", "source_port": "exec_out", "target_node": "end_001", "target_port": "exec_in"}
    ],
    "frames": [],
    "variables": {
      "row_count": {
        "type": "Integer",
        "default_value": 0,
        "description": "Number of rows extracted"
      }
    },
    "settings": {
      "stop_on_error": true,
      "timeout": 120,
      "retry_count": 0
    }
  },
  "usage_stats": {
    "total_uses": 0,
    "last_used": null,
    "successful_instantiations": 0,
    "failed_instantiations": 0,
    "average_rating": null,
    "rating_count": 0
  },
  "is_builtin": true,
  "source": "builtin",
  "marketplace_id": null
}
