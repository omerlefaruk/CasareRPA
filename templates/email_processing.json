{
  "$schema": "casare_rpa/workflow_template/1.0",
  "id": "tmpl_email_001",
  "metadata": {
    "name": "Email Processing",
    "description": "Processes emails from IMAP/POP3 mailboxes. Supports reading, filtering, extracting attachments, and automated responses.",
    "category": "email_processing",
    "version": "1.0.0",
    "author": "CasareRPA",
    "tags": ["email", "imap", "attachments", "automation", "inbox"],
    "created_at": "2024-11-28T00:00:00",
    "modified_at": "2024-11-28T00:00:00",
    "icon": "email",
    "preview_image": "",
    "difficulty": "intermediate",
    "estimated_duration": "2-10 minutes",
    "requirements": ["imaplib", "Internet connection", "Email credentials"]
  },
  "parameters": [
    {
      "name": "email_server",
      "display_name": "Email Server",
      "description": "IMAP server address (e.g., imap.gmail.com)",
      "param_type": "string",
      "default_value": "imap.gmail.com",
      "required": true,
      "constraints": {},
      "group": "Connection",
      "order": 0
    },
    {
      "name": "email_port",
      "display_name": "Port",
      "description": "IMAP server port (993 for SSL)",
      "param_type": "integer",
      "default_value": 993,
      "required": false,
      "constraints": {"min": 1, "max": 65535},
      "group": "Connection",
      "order": 1
    },
    {
      "name": "email_credential",
      "display_name": "Email Credential",
      "description": "Credential reference for email login",
      "param_type": "credential",
      "default_value": null,
      "required": true,
      "constraints": {},
      "group": "Connection",
      "order": 2
    },
    {
      "name": "folder",
      "display_name": "Mail Folder",
      "description": "Folder to read emails from",
      "param_type": "string",
      "default_value": "INBOX",
      "required": false,
      "constraints": {},
      "group": "Filtering",
      "order": 3
    },
    {
      "name": "unread_only",
      "display_name": "Unread Only",
      "description": "Only process unread emails",
      "param_type": "boolean",
      "default_value": true,
      "required": false,
      "constraints": {},
      "group": "Filtering",
      "order": 4
    },
    {
      "name": "subject_filter",
      "display_name": "Subject Filter",
      "description": "Filter emails by subject (substring match)",
      "param_type": "string",
      "default_value": "",
      "required": false,
      "constraints": {},
      "group": "Filtering",
      "order": 5
    },
    {
      "name": "sender_filter",
      "display_name": "Sender Filter",
      "description": "Filter emails by sender address",
      "param_type": "string",
      "default_value": "",
      "required": false,
      "constraints": {},
      "group": "Filtering",
      "order": 6
    },
    {
      "name": "max_emails",
      "display_name": "Max Emails",
      "description": "Maximum number of emails to process (0 = unlimited)",
      "param_type": "integer",
      "default_value": 10,
      "required": false,
      "constraints": {"min": 0, "max": 1000},
      "group": "Filtering",
      "order": 7
    },
    {
      "name": "extract_attachments",
      "display_name": "Extract Attachments",
      "description": "Download email attachments",
      "param_type": "boolean",
      "default_value": false,
      "required": false,
      "constraints": {},
      "group": "Actions",
      "order": 8
    },
    {
      "name": "attachment_folder",
      "display_name": "Attachment Folder",
      "description": "Directory to save attachments",
      "param_type": "directory_path",
      "default_value": "./attachments",
      "required": false,
      "constraints": {},
      "group": "Actions",
      "order": 9
    },
    {
      "name": "mark_as_read",
      "display_name": "Mark as Read",
      "description": "Mark processed emails as read",
      "param_type": "boolean",
      "default_value": true,
      "required": false,
      "constraints": {},
      "group": "Actions",
      "order": 10
    }
  ],
  "workflow_definition": {
    "metadata": {
      "name": "Email Processing Workflow",
      "description": "Generated from Email Processing template",
      "version": "1.0.0"
    },
    "nodes": {
      "start_001": {
        "node_id": "start_001",
        "node_type": "StartNode",
        "name": "Start",
        "position": [100, 200],
        "config": {}
      },
      "email_connect_001": {
        "node_id": "email_connect_001",
        "node_type": "EmailConnectNode",
        "name": "Connect to Mailbox",
        "position": [300, 200],
        "config": {
          "server": "{{email_server}}",
          "port": "{{email_port}}",
          "credential": "{{email_credential}}",
          "use_ssl": true
        }
      },
      "email_fetch_001": {
        "node_id": "email_fetch_001",
        "node_type": "EmailFetchNode",
        "name": "Fetch Emails",
        "position": [500, 200],
        "config": {
          "folder": "{{folder}}",
          "unread_only": "{{unread_only}}",
          "subject_filter": "{{subject_filter}}",
          "sender_filter": "{{sender_filter}}",
          "max_emails": "{{max_emails}}"
        }
      },
      "loop_001": {
        "node_id": "loop_001",
        "node_type": "ForEachNode",
        "name": "Process Each Email",
        "position": [700, 200],
        "config": {}
      },
      "log_email_001": {
        "node_id": "log_email_001",
        "node_type": "LogNode",
        "name": "Log Email Info",
        "position": [900, 100],
        "config": {
          "message": "Processing: {{email_subject}} from {{email_sender}}"
        }
      },
      "branch_attach_001": {
        "node_id": "branch_attach_001",
        "node_type": "BranchNode",
        "name": "Has Attachments?",
        "position": [1100, 200],
        "config": {
          "condition": "{{extract_attachments}} and {{has_attachments}}"
        }
      },
      "save_attach_001": {
        "node_id": "save_attach_001",
        "node_type": "SaveAttachmentNode",
        "name": "Save Attachments",
        "position": [1300, 100],
        "config": {
          "output_folder": "{{attachment_folder}}"
        }
      },
      "branch_mark_001": {
        "node_id": "branch_mark_001",
        "node_type": "BranchNode",
        "name": "Mark as Read?",
        "position": [1500, 200],
        "config": {
          "condition": "{{mark_as_read}}"
        }
      },
      "mark_read_001": {
        "node_id": "mark_read_001",
        "node_type": "EmailMarkReadNode",
        "name": "Mark as Read",
        "position": [1700, 100],
        "config": {}
      },
      "email_disconnect_001": {
        "node_id": "email_disconnect_001",
        "node_type": "EmailDisconnectNode",
        "name": "Disconnect",
        "position": [1900, 200],
        "config": {}
      },
      "end_001": {
        "node_id": "end_001",
        "node_type": "EndNode",
        "name": "End",
        "position": [2100, 200],
        "config": {}
      }
    },
    "connections": [
      {"source_node": "start_001", "source_port": "exec_out", "target_node": "email_connect_001", "target_port": "exec_in"},
      {"source_node": "email_connect_001", "source_port": "exec_out", "target_node": "email_fetch_001", "target_port": "exec_in"},
      {"source_node": "email_connect_001", "source_port": "connection", "target_node": "email_fetch_001", "target_port": "connection"},
      {"source_node": "email_fetch_001", "source_port": "exec_out", "target_node": "loop_001", "target_port": "exec_in"},
      {"source_node": "email_fetch_001", "source_port": "emails", "target_node": "loop_001", "target_port": "items"},
      {"source_node": "loop_001", "source_port": "loop_body", "target_node": "log_email_001", "target_port": "exec_in"},
      {"source_node": "log_email_001", "source_port": "exec_out", "target_node": "branch_attach_001", "target_port": "exec_in"},
      {"source_node": "branch_attach_001", "source_port": "true", "target_node": "save_attach_001", "target_port": "exec_in"},
      {"source_node": "branch_attach_001", "source_port": "false", "target_node": "branch_mark_001", "target_port": "exec_in"},
      {"source_node": "save_attach_001", "source_port": "exec_out", "target_node": "branch_mark_001", "target_port": "exec_in"},
      {"source_node": "branch_mark_001", "source_port": "true", "target_node": "mark_read_001", "target_port": "exec_in"},
      {"source_node": "branch_mark_001", "source_port": "false", "target_node": "loop_001", "target_port": "loop_next"},
      {"source_node": "mark_read_001", "source_port": "exec_out", "target_node": "loop_001", "target_port": "loop_next"},
      {"source_node": "loop_001", "source_port": "exec_out", "target_node": "email_disconnect_001", "target_port": "exec_in"},
      {"source_node": "email_disconnect_001", "source_port": "exec_out", "target_node": "end_001", "target_port": "exec_in"}
    ],
    "frames": [],
    "variables": {
      "email_count": {
        "type": "Integer",
        "default_value": 0,
        "description": "Number of emails processed"
      },
      "attachment_count": {
        "type": "Integer",
        "default_value": 0,
        "description": "Number of attachments saved"
      }
    },
    "settings": {
      "stop_on_error": false,
      "timeout": 300,
      "retry_count": 1
    }
  },
  "usage_stats": {
    "total_uses": 0,
    "last_used": null,
    "successful_instantiations": 0,
    "failed_instantiations": 0,
    "average_rating": null,
    "rating_count": 0
  },
  "is_builtin": true,
  "source": "builtin",
  "marketplace_id": null
}
