# CasareRPA Cloud Orchestrator - Railway Configuration
# https://docs.railway.app/deploy/config-as-code
#
# DEPLOYMENT:
#   1. Install Railway CLI: npm i -g @railway/cli
#   2. Login: railway login
#   3. Create project: railway init
#   4. Add PostgreSQL: railway add --plugin postgresql
#   5. Add Redis (optional): railway add --plugin redis
#   6. Set variables in dashboard: API_SECRET
#   7. Deploy: railway up
#
# DATABASE_URL and REDIS_URL are auto-populated by Railway plugins.

[build]
builder = "dockerfile"
dockerfilePath = "deploy/docker/Dockerfile"
target = "orchestrator-cloud"

watchPatterns = [
    "src/casare_rpa/**",
    "deploy/docker/**",
    "deploy/orchestrator/**"
]

[deploy]
numReplicas = 1
healthcheckPath = "/health"
healthcheckTimeout = 10
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[env]
# Server configuration
PORT = { required = true, default = "8000" }
HOST = { default = "0.0.0.0" }
WORKERS = { default = "1" }

# Database (Railway PostgreSQL plugin auto-populates DATABASE_URL)
DATABASE_URL = { required = false }

# Redis (Railway Redis plugin auto-populates REDIS_URL)
REDIS_URL = { required = false }

# Supabase integration (optional)
SUPABASE_URL = { required = false }
SUPABASE_KEY = { required = false }

# Security
API_SECRET = { required = true }
CORS_ORIGINS = { default = "*" }

# Timeouts
ROBOT_HEARTBEAT_TIMEOUT = { default = "90" }
JOB_TIMEOUT_DEFAULT = { default = "3600" }
WS_PING_INTERVAL = { default = "30" }
